{% extends "base.html" %}
{% block title %}QR Code para {{ equipment.code }}{% endblock %}
{% block header %}QR Code do Equipamento{% endblock %}

{% block head %}
<style>
    @media print {
        body * { visibility: hidden; }
        #printable-area, #printable-area * { visibility: visible; }
        #printable-area { position: absolute; left: 0; top: 0; width: 100%; }
        .no-print { display: none; }
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-md mx-auto">
    <div id="printable-area" class="bg-white p-8 rounded-lg shadow-lg text-center">
        <h2 class="text-xl font-bold text-gray-800">{{ equipment.code }}</h2>
        <p class="text-gray-600">{{ equipment.model }}</p>
        <p class="text-sm text-gray-500 mt-1">Cliente: {{ equipment.client.name }}</p>
        
        <div class="mt-6 flex justify-center">
            <!-- CORREÇÃO: A imagem agora é gerada usando 'equipment.code' -->
            <img src="{{ url_for('qrcode.qrcode_image', code=equipment.code) }}" alt="QR Code para o equipamento {{ equipment.code }}" class="w-64 h-64">
        </div>

        <p class="mt-6 text-xs text-gray-400">
            Aponte a câmera do seu celular para este código para ver o histórico de manutenção.
        </p>
    </div>

    <div class="mt-6 text-center no-print">
        <button onclick="window.print()" class="w-full justify-center inline-flex items-center rounded-md bg-indigo-600 px-4 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500">
            <i class="fas fa-print mr-2"></i>Imprimir QR Code
        </button>
        <a href="{{ url_for('core.dashboard') }}" class="mt-2 block text-sm text-gray-600 hover:underline">Voltar ao Dashboard</a>
    </div>
</div>
{% endblock %}
